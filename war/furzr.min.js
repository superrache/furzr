(function(a){return a.extend({MD5:function(a){var h,m,r,t,p,k,x,g,y,u,z,s,w,v,d,e,f,c,l,b;w=function(a,b){return a<<b|a>>>32-b};h=function(a,b){var g,c,d,f,e;d=a&2147483648;e=b&2147483648;c=a&1073741824;f=b&1073741824;g=(a&1073741823)+(b&1073741823);return c&f?g^2147483648^d^e:c|f?g&1073741824?g^3221225472^d^e:g^1073741824^d^e:g^d^e};p=function(a,b,g){return a&b|~a&g};x=function(a,b,g){return a&g|b&~g};y=function(a,b,g){return a^b^g};z=function(a,b,g){return b^(a|~g)};k=function(a,b,g,c,d,f,e){a=
h(a,h(h(p(b,g,c),d),e));return h(w(a,f),b)};g=function(a,b,g,c,d,f,e){a=h(a,h(h(x(b,g,c),d),e));return h(w(a,f),b)};u=function(a,b,g,c,d,f,e){a=h(a,h(h(y(b,g,c),d),e));return h(w(a,f),b)};s=function(a,b,g,c,d,f,e){a=h(a,h(h(z(b,g,c),d),e));return h(w(a,f),b)};v=function(a){var b,g,c;b="";for(c=0;3>=c;)g=a>>>8*c&255,g="0"+g.toString(16),b+=g.substr(g.length-2,2),c++;return b};b=[];a=function(a){var b,g,c;a=a.replace(/\r\n/g,"\n");c="";for(g=0;g<a.length;)b=a.charCodeAt(g),128>b?c+=String.fromCharCode(b):
(127<b&&2048>b?c+=String.fromCharCode(b>>6|192):(c+=String.fromCharCode(b>>12|224),c+=String.fromCharCode(b>>6&63|128)),c+=String.fromCharCode(b&63|128)),g++;return c}(a);b=function(a){var b,g,c,d,f,e;c=a.length;b=c+8;d=16*((b-b%64)/64+1);f=Array(d-1);for(b=0;b<c;)e=(b-b%4)/4,g=8*(b%4),f[e]|=a.charCodeAt(b)<<g,b++;e=(b-b%4)/4;f[e]|=128<<8*(b%4);f[d-2]=c<<3;f[d-1]=c>>>29;return f}(a);d=1732584193;e=4023233417;f=2562383102;c=271733878;for(l=0;l<b.length;)a=d,m=e,r=f,t=c,d=k(d,e,f,c,b[l+0],7,3614090360),
c=k(c,d,e,f,b[l+1],12,3905402710),f=k(f,c,d,e,b[l+2],17,606105819),e=k(e,f,c,d,b[l+3],22,3250441966),d=k(d,e,f,c,b[l+4],7,4118548399),c=k(c,d,e,f,b[l+5],12,1200080426),f=k(f,c,d,e,b[l+6],17,2821735955),e=k(e,f,c,d,b[l+7],22,4249261313),d=k(d,e,f,c,b[l+8],7,1770035416),c=k(c,d,e,f,b[l+9],12,2336552879),f=k(f,c,d,e,b[l+10],17,4294925233),e=k(e,f,c,d,b[l+11],22,2304563134),d=k(d,e,f,c,b[l+12],7,1804603682),c=k(c,d,e,f,b[l+13],12,4254626195),f=k(f,c,d,e,b[l+14],17,2792965006),e=k(e,f,c,d,b[l+15],22,1236535329),
d=g(d,e,f,c,b[l+1],5,4129170786),c=g(c,d,e,f,b[l+6],9,3225465664),f=g(f,c,d,e,b[l+11],14,643717713),e=g(e,f,c,d,b[l+0],20,3921069994),d=g(d,e,f,c,b[l+5],5,3593408605),c=g(c,d,e,f,b[l+10],9,38016083),f=g(f,c,d,e,b[l+15],14,3634488961),e=g(e,f,c,d,b[l+4],20,3889429448),d=g(d,e,f,c,b[l+9],5,568446438),c=g(c,d,e,f,b[l+14],9,3275163606),f=g(f,c,d,e,b[l+3],14,4107603335),e=g(e,f,c,d,b[l+8],20,1163531501),d=g(d,e,f,c,b[l+13],5,2850285829),c=g(c,d,e,f,b[l+2],9,4243563512),f=g(f,c,d,e,b[l+7],14,1735328473),
e=g(e,f,c,d,b[l+12],20,2368359562),d=u(d,e,f,c,b[l+5],4,4294588738),c=u(c,d,e,f,b[l+8],11,2272392833),f=u(f,c,d,e,b[l+11],16,1839030562),e=u(e,f,c,d,b[l+14],23,4259657740),d=u(d,e,f,c,b[l+1],4,2763975236),c=u(c,d,e,f,b[l+4],11,1272893353),f=u(f,c,d,e,b[l+7],16,4139469664),e=u(e,f,c,d,b[l+10],23,3200236656),d=u(d,e,f,c,b[l+13],4,681279174),c=u(c,d,e,f,b[l+0],11,3936430074),f=u(f,c,d,e,b[l+3],16,3572445317),e=u(e,f,c,d,b[l+6],23,76029189),d=u(d,e,f,c,b[l+9],4,3654602809),c=u(c,d,e,f,b[l+12],11,3873151461),
f=u(f,c,d,e,b[l+15],16,530742520),e=u(e,f,c,d,b[l+2],23,3299628645),d=s(d,e,f,c,b[l+0],6,4096336452),c=s(c,d,e,f,b[l+7],10,1126891415),f=s(f,c,d,e,b[l+14],15,2878612391),e=s(e,f,c,d,b[l+5],21,4237533241),d=s(d,e,f,c,b[l+12],6,1700485571),c=s(c,d,e,f,b[l+3],10,2399980690),f=s(f,c,d,e,b[l+10],15,4293915773),e=s(e,f,c,d,b[l+1],21,2240044497),d=s(d,e,f,c,b[l+8],6,1873313359),c=s(c,d,e,f,b[l+15],10,4264355552),f=s(f,c,d,e,b[l+6],15,2734768916),e=s(e,f,c,d,b[l+13],21,1309151649),d=s(d,e,f,c,b[l+4],6,4149444226),
c=s(c,d,e,f,b[l+11],10,3174756917),f=s(f,c,d,e,b[l+2],15,718787259),e=s(e,f,c,d,b[l+9],21,3951481745),d=h(d,a),e=h(e,m),f=h(f,r),c=h(c,t),l+=16;return(v(d)+v(e)+v(f)+v(c)).toLowerCase()}})})(jQuery);function ajaxError(a,n,h,m){401!=a.status&&$.ajax({type:"GET",data:{time:(new Date).getTime(),email:"error_reporting",message:a.status+" "+a.statusText+" "+h+" "+JSON.stringify(m)+" "+a.responseText},url:"contact"});return a.status}function replaceAll(a,n,h){return a.replace(RegExp(n,"g"),h)}function getURLParameter(a){return decodeURI((RegExp(a+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}
function setFocusOn(a){-1!=navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")||$(a).focus()};(function(a){var n=!1,h,m=!1,r=!1,t=!1,p,k=0,x=function(b){n&&a("#audio_artist_overview_preview").get(0).play()},g=function(a){y(!n)},y=function(b){(n=b)?(a("#audio_artist_overview_preview").get(0).play(),a("#button_sound_volume").html('<img src="img/volume_on.png">')):(a("#audio_artist_overview_preview").get(0).pause(),a("#button_sound_volume").html('<img src="img/volume_off.png">'),a("#div_sound_title").html(""))},u=function(a){if(a.hasOwnProperty("toptracks")&&a.toptracks.hasOwnProperty("track")&&
1<=a.toptracks.track.length){p=Array(a.toptracks.track.length);for(var g in a.toptracks.track)p[g]=a.toptracks.track[g].artist.name+" "+a.toptracks.track[g].name;s(0)}else c()},z=function(a){p.length>k+1&&s(k+1)},s=function(b){k=b;if(m)d(p[b]);else{var g={q:p[b],oauth_consumer_key:"7d2kx6pbdwyv",pagesize:1};a.ajax({type:"GET",url:"http://api.7digital.com/1.2/track/search",data:g,crossDomain:!0,dataType:"xml",success:w,error:function(a,b,c){401===ajaxError(a,b,c,g)&&l();m=!0;d(g.q)}})}},w=function(b){var g=
"",d="",e="",p="",k="";a(b).find("track").each(function(){g=a(this).attr("id");d=a(this).find("title").first().text();k=a(this).find("url").last().text();a(this).find("artist").each(function(){e=a(this).find("name").first().text()});a(this).find("release").each(function(){p=a(this).find("title").first().text()})});""!=g?a.ajax({type:"GET",url:"http://api.7digital.com/1.2/track/preview",data:{trackid:g,oauth_consumer_key:"7d2kx6pbdwyv",redirect:!1},crossDomain:!0,dataType:"xml",success:function(b){f(a(b).find("url").text())},
error:function(a,b,g){401===ajaxError(a,b,g,dataTrackSearch)&&l();m=!0}}):c();v(e,k,d,p)},v=function(b,g,c,d){""!==g&&a("#div_sound_title").html(b+' - <a href="'+g+'" target="_blank">'+c+"</a><br/><i>"+d+"</i>")},d=function(b){a.ajax({type:"GET",data:{time:(new Date).getTime(),q:b},url:"gettoptrackpreviewurl",success:e})},e=function(a){a=jQuery.parseJSON(a);a.hasOwnProperty("url")&&(v(a.artistName,a.trackUrl,a.trackTitle,a.albumTitle),f(a.url))},f=function(g){null!=g||""!=g?a("#audio_artist_overview_preview").attr("src",
g):c();r=!1},c=function(){a("#div_sound_title").html("<i>No preview song available</i>");r=!1},l=function(){a("#div_sound_title").html("<i>Preview service unavailable</i>");r=!1;t=!0};previewSevenDigital="undefined"!==typeof previewSevenDigital?previewSevenDigital:{};a.extend(previewSevenDigital,{init:function(b,c,d){y(b);a("#button_sound_volume").click(g);a("#audio_artist_overview_preview").bind("ended",z);m=c;h=d;a("#canvas").click(x)},loadPreview:function(g){!n||(r||t)||(r=!0,a("#div_sound_title").html(h),
g.success=u,a.ajax(g))}})})(this.jQuery);(function(a){var n=function(a,m){""!==m.mbid?a.mbid=m.mbid:a.artist=m.name;return a};apiLastFM="undefined"!==typeof apiLastFM?apiLastFM:{};a.extend(apiLastFM,{init:function(a,m,r,t,p){previewSevenDigital.init(m,r,t)},getApiName:function(){return"lastfm"},getArtistId:function(a){return""!==a.mbid?a.mbid:a.name},getCorrection:function(h,m){var r={method:"artist.search",artist:h,limit:10,page:1,api_key:"a5ca8d5706cd79676a9b3e5748ba0848",format:"json"};a.ajax({type:"GET",url:"http://ws.audioscrobbler.com/2.0/",
data:r,crossDomain:!0,dataType:"jsonp",success:function(a){if(a.hasOwnProperty("results")&&a.results.hasOwnProperty("artistmatches")&&a.results.artistmatches.hasOwnProperty("artist")){var p=null;if(0<a.results.artistmatches.artist.length){var k=a.results["@attr"],h;for(h in a.results.artistmatches.artist)if(a.results.artistmatches.artist[h].name.toLowerCase()===k["for"].toLowerCase()){p=a.results.artistmatches.artist[h];break}null===p&&(p=a.results.artistmatches.artist[0])}else p=a.results.artistmatches.artist;
m(p)}else m(null)},error:function(a,p,k){a=ajaxError(a,p,k,r);0!==a&&404!==a&&503!==a||m({error:a})}})},getSimilars:function(h,m){dataGetSimilar={method:"artist.getsimilar",api_key:"a5ca8d5706cd79676a9b3e5748ba0848",format:"json"};dataGetSimilar=n(dataGetSimilar,h);a.ajax({type:"GET",url:"http://ws.audioscrobbler.com/2.0/",data:dataGetSimilar,crossDomain:!0,dataType:"jsonp",success:function(a){a.hasOwnProperty("similarartists")&&a.similarartists.artist[0].hasOwnProperty("name")?m(a.similarartists.artist):
m(null)},error:function(a,h,p){a=ajaxError(a,h,p,dataSearch);0!==a&&404!==a&&503!==a||m({error:a})}})},getInfos:function(h,m){var r={method:"artist.getinfo",api_key:"a5ca8d5706cd79676a9b3e5748ba0848",format:"json"},t={method:"artist.gettoptracks",limit:"5",api_key:"a5ca8d5706cd79676a9b3e5748ba0848",format:"json"},r=n(r,h),t=n(t,h);a.ajax({type:"GET",url:"http://ws.audioscrobbler.com/2.0/",data:r,crossDomain:!0,dataType:"jsonp",success:function(a){if(a.hasOwnProperty("artist")){a=a.artist;var k={name:a.name,
url:a.url,bio:a.bio.summary,tags:"",image:""},h;for(h in a.image){var g=a.image[h];if("large"===g.size){k.image=g["#text"];break}}for(h in a.tags.tag)k.tags+=a.tags.tag[h].name+" ";m(k)}else m(null)},error:function(a,k,h){ajaxError(a,k,h,r)}});previewSevenDigital.loadPreview({type:"GET",url:"http://ws.audioscrobbler.com/2.0/",data:t,crossDomain:!0,dataType:"jsonp",error:function(a,k,h){ajaxError(a,k,h,t)}})}})})(this.jQuery);(function(a){var n,h,m,r=function(a,k){if(a.hasOwnProperty("code"))if(200===a.code)if(a.hasOwnProperty("similars")){if(0<a.similars.length){k(a.similars);return}}else if(a.hasOwnProperty("followers")){if(0<a.followers.length){k(a.followers);return}}else if(a.hasOwnProperty("influencers")){if(0<a.influencers.length){k(a.influencers);return}}else{if(a.hasOwnProperty("related")){if(a.related.hasOwnProperty("isRelatedTo")&&-1!=h.indexOf("related")){var m=[],g;for(g in a.related.isRelatedTo){if(g>n)break;
m[g]={id:a.related.isRelatedTo[g].ids.movieId,name:a.related.isRelatedTo[g].title}}k(m);return}if(a.related.hasOwnProperty("similarTo")&&-1!=h.indexOf("similars")){m=[];for(g in a.related.similarTo){if(g>n)break;m[g]={id:a.related.similarTo[g].ids.movieId,name:a.related.similarTo[g].title}}k(m);return}}}else{k(null);return}else if(a.hasOwnProperty("error")){k(a);return}k(null)},t=function(a){for(var k=0;k<a.length;){if("["===a.charAt(k)){var h=a.substring(k).indexOf("]"),h=a.substring(k,k+h+1);a=
a.replace(h,"")}k++}return a};apiAmg="undefined"!==typeof apiAmgSimilar?apiAmg:{};a.extend(apiAmg,{init:function(a,k,r,g,y){n=a;h=y;m="en-US"},getApiName:function(){return h},getArtistId:function(a){return a.id},getCorrection:function(p,k){var n={method:"getcorrection",name:p,datatype:h,local:m};a.ajax({type:"GET",url:"amgproxy",data:n,crossDomain:!0,dataType:"json",success:function(a){a.hasOwnProperty("code")?200===a.code?a.hasOwnProperty("name")?k({id:a.name.ids.nameId,name:a.name.name}):a.hasOwnProperty("movie")&&
k({id:a.movie.ids.movieId,name:a.movie.title}):k(null):a.hasOwnProperty("error")?k(a):k(null)},error:function(a,h,m){a=ajaxError(a,h,m,n);0!==a&&404!==a&&503!==a||k({error:a})}})},getSimilars:function(p,k){var t={method:"getsimilars",id:p.id,number:n,datatype:h,local:m};a.ajax({type:"GET",url:"amgproxy",data:t,crossDomain:!0,dataType:"json",success:function(a){r(a,k)},error:function(a,h,m){a=ajaxError(a,h,m,t);0!==a&&404!==a&&503!==a||k({error:a})}})},getInfos:function(p,k){var n={method:"getinfos",
id:p.id,datatype:h,local:m};a.ajax({type:"GET",url:"amgproxy",data:n,crossDomain:!0,dataType:"json",success:function(a){if(a.hasOwnProperty("code"))if(200===a.code)if(a.hasOwnProperty("name")){var h=replaceAll(a.name.name," ","+"),h={name:a.name.name,bio:t(a.name.headlineBio),tags:"",image:"",url:"http://www.lastfm.com/music/"+h},m;for(m in a.name.musicGenres)h.tags+=a.name.musicGenres[m].name+" ";null!=a.name.images&&0<a.name.images.length&&(h.image=a.name.images[0].url);k(h)}else{if(a.hasOwnProperty("movie")){h=
replaceAll(a.movie.title," ","+");h={name:a.movie.title,bio:t(a.movie.synopsis.text),tags:"",image:"",url:"http://www.youtube.com/results?search_query="+h+"+teaser"};for(m in a.movie.genres)h.tags+=a.movie.genres[m].name+" ";null!=a.movie.images&&0<a.movie.images.length&&(h.image=a.movie.images[0].url);k(h)}}else k(null);else a.hasOwnProperty("error")?k(a):k(null)},error:function(a,h,m){a=ajaxError(a,h,m,n);0!==a&&404!==a&&503!==a||k({error:a})}})}})})(this.jQuery);(function(a){var n,h,m,r=0,t=16,p=[],k=[],x=null,g=1,y=!1,u=!0,z=!1,s=!1,w="",v="",d=[],e=0,f=!1,c="",l=function(q){q=a(q).get(0);var b=q.getContext("2d"),c,d={init:function(q){c=q;c.screen({size:{width:a(window).width(),height:a(window).height()},padding:80});a(window).resize(d.resize);d.resize();d.initMouseHandling()},resize:function(){q.width=a(window).width();q.height=a(window).height();c.screen({size:{width:a(window).width(),height:a(window).height()},padding:80});d.redraw()},redraw:function(){b.fillStyle=
"#FFFFFF";b.fillRect(0,0,q.width,q.height);c.eachEdge(function(a,q,c){b.strokeStyle="rgba(0,0,0, 0.5)";b.lineWidth=0.5;b.beginPath();b.moveTo(q.x,q.y);b.lineTo(c.x,c.y);b.stroke()});c.eachNode(function(a,q){b.beginPath();b.arc(q.x,q.y,20,0,2*Math.PI,!1);b.lineWidth=1;b.strokeStyle="rgba(0,0,0, 0.1)";b.stroke();b.fillStyle=a.data.isInput?"#DE00FF":a.data.isExploded?"#2572B8":"#FF5500";b.font="bold 8pt Tahoma";b.fillText(a.data.name,q.x,q.y)})},initMouseHandling:function(){var b=null,d=!1,e=0,f=0,h=
0,l=0,m={clicked:function(b){if(d&&0!=e&&0!=f&&10<Math.abs(e-h)&&10<Math.abs(f-l))d=!1;else{var m=a(q).offset();_mouseP=arbor.Point(b.pageX-m.left,b.pageY-m.top);b=c.nearest(_mouseP);null!=b&&(null!=b.node&&20>b.distance)&&(I(b.node.data),-1===a.inArray(b.node.name,k)&&k.push(b.node.name),v=b.node.data.name,A(),B("",""),a("#div_cs_saved").html(),G(b.node.data),2===g&&(a("#tooltip_mouseover").fadeOut("slow"),g=3))}},mousedown:function(d){var g=a(q).offset();e=d.pageX-g.left;f=d.pageY-g.top;_mouseP=
arbor.Point(d.pageX-g.left,d.pageY-g.top);(b=c.nearest(_mouseP))&&null!==b.node&&(b.node.fixed=!0);a(q).bind("mousemove",m.dragged);a(window).bind("mouseup",m.dropped);return!1},dragged:function(e){d=!0;var f=a(q).offset();e=arbor.Point(e.pageX-f.left,e.pageY-f.top);b&&null!==b.node&&(e=c.fromScreen(e),b.node.p=e);return!1},dropped:function(c){if(null!==b&&void 0!==b.node){null!==b.node&&(b.node.fixed=!1);var d=a(q).offset();h=c.pageX-d.left;l=c.pageY-d.top;b.node.tempMass=1E3;b=null;a(q).unbind("mousemove",
m.dragged);a(window).unbind("mouseup",m.dropped);_mouseP=null;return!1}},mousemoved:function(d){if(null===b){var e=a(q).offset();_mouseP=arbor.Point(d.pageX-e.left,d.pageY-e.top);c.nearest(_mouseP)}}};a(q).mousedown(m.mousedown);a(q).mousemove(m.mousemoved);a(q).click(m.clicked)}};return d},b=function(a){13===(a.keyCode?a.keyCode:a.which)&&E()},E=function(){var b=a("#input_artist").val();F(b);""!=b&&a.ajax({type:"GET",url:"artistinput",data:{time:(new Date).getTime(),artistinput:b}})},F=function(b){null!=
b&&""!=b&&(a("#button_artist").html('<img src="theme/blue/spinner.gif"/>'),1===g&&(a("#div_voile").fadeOut(),a(".state_header_normal").toggleClass("state_header_start",!1),a(".state_div_input_artist_normal").toggleClass("state_div_input_artist_start",!1),setTimeout(function(){C()},1020)),h.getCorrection(b,P))},P=function(b){if(null!=b){if(b.hasOwnProperty("name")){b.distance=0;b.isInput=!0;b.isExploded=!1;x=b;p.push(h.getArtistId(b));G(b);I(b);return}b.hasOwnProperty("error")&&(a("#tooltip_service_unavailable_error").fadeIn("fast"),
setTimeout(function(){a("#tooltip_service_unavailable_error").fadeOut("fast")},3E3))}else a("#tooltip_input_artist_unknown").fadeIn("fast"),setTimeout(function(){a("#tooltip_input_artist_unknown").fadeOut("fast")},3E3);a("#button_artist").html("Add")},G=function(a){m=a;h.getSimilars(a,Q)},Q=function(b){if(null!=b)if(0<b.length){null!=x&&(n.addNode(h.getArtistId(x),x),1===p.length&&(v=w=x.name,A()),1===g&&(setTimeout(function(){a("#tooltip_help_1").fadeIn("slow")},2500),g=2),a("#button_artist").html("Add"),
x=null);R();for(var c in b)if(c<t){var d=b[c];d.distance=m.distance+1;d.distance>r&&(r=d.distance);var e=h.getArtistId(d),f=h.getArtistId(m);d.isInput=0<=a.inArray(e,p);d.isExploded=0<=a.inArray(e,k);m.isExploded=0<=a.inArray(f,k);n.addNode(e,d);0===n.getEdges(e,f).length&&n.addEdge(f,e)}3===g&&(setTimeout(function(){a("#tooltip_help_1").hide();a("#tooltip_help_2").fadeIn("slow");setTimeout(function(){a("#tooltip_help_2").fadeOut("slow")},7E3)},2E3),g=4)}else b.hasOwnProperty("error")&&(a("#tooltip_service_unavailable_error").fadeIn("fast"),
setTimeout(function(){a("#tooltip_service_unavailable_error").fadeOut("fast")},3E3));else a("#tooltip_no_similars_error").fadeIn("fast"),setTimeout(function(){a("#tooltip_no_similars_error").fadeOut("fast")},3E3)},R=function(){n.eachNode(function(b,c){-1===a.inArray(b.name,p)&&-1===a.inArray(b.name,k)&&n.pruneNode(b)})},S=function(){H(!1)},H=function(b){n.eachNode(function(a,b){n.pruneNode(a)});p=[];k=[];m=null;r=0;x=null;v=w="";A();b||B(null,null);a("#button_artist").html("Add")},U=function(){if(""!=
a("#input_contact_email").val()||""!=a("#input_contact_message").val())a("#button_contact_send").hide(),a.ajax({type:"GET",data:{time:(new Date).getTime(),email:a("#input_contact_email").val(),message:a("#input_contact_message").val()},url:"contact",success:T})},T=function(b){a("#div_contact_message_sent").show();a("#input_contact_email").val("");a("#input_contact_message").val("");setTimeout(function(){a("#div_contact_message_sent").fadeOut("fast");setTimeout(function(){a("#button_contact_send").show()},
500)},2E3)},A=function(){""!=w&&""!=v?(c="This map shows how to connect "+w+" to "+v,a("#h_snake_description").html(c),a("#div_cs_save_form").is(":hidden")&&a("#button_cs_save").show()):(c="",a("#h_snake_description").html("Expand your artist map"),a("#button_cs_save").hide())},V=function(b){a("#button_cs_save").hide();a("#div_cs_save_form").show();setFocusOn("#input_cs_name")},X=function(b){if(""===a("#input_cs_name").val())a("#input_cs_name").css("border-color","red");else{a("#input_cs_name").css("border-color",
"white");a("#button_cs_save_form").hide();a("#spinner_cs_save_form").show();b={};var c=n.getNode(p[0]);d=[];b.api=h.getApiName();b.artistA={};b.artistA.id=h.getArtistId(c.data);b.artistA.name=c.data.name;d.push(c.data.name);b.artistA.isInput=!0;b.artistA.isExploded=!0;b.artistA.children=J(c);b.inputIds=p;b.explodedIds=k;e=K(b.artistA,!0);b=JSON.stringify(b);a.ajax({type:"POST",data:{time:(new Date).getTime(),csName:a("#input_cs_name").val(),csPseudo:a("#input_cs_pseudo").val(),csArtistA:w,csArtistB:v,
csLength:e,csJSON:b},url:"savecs",success:W})}},J=function(b){var c=[];b=n.getEdgesFrom(b);if(0>=b.length)return null;for(var e in b){var f=b[e].target,g={};g.id=h.getArtistId(f.data);g.name=f.data.name;g.isInput=f.data.isInput;(g.isExploded=f.data.isExploded)&&-1===a.inArray(f.data.name,d)&&(d.push(f.data.name),g.children=J(f));c.push(g)}return c},K=function(a,b){var c=[];if(null===a.children)return 0;for(var d in a.children)a.children[d].hasOwnProperty("children")?c[d]=1+K(a.children[d],!1):c[d]=
1;if(b){var e=Math.max.apply(null,c);for(d in c)if(c[d]===e){c[d]=0;break}c=Math.max.apply(null,c);return e+c}return Math.max.apply(null,c)},W=function(b){a("#div_cs_save_form").hide();a("#button_cs_save_form").show();a("#spinner_cs_save_form").hide();b=jQuery.parseJSON(b);b.hasOwnProperty("csid")?(a("#div_cs_saved").html("Your artist map has been successfully saved"),B(a("#input_cs_name").val(),b.csid)):a("#div_cs_saved").html("An error occured... Retry more later please.");a("#div_cs_saved").slideDown("fast");
L()},B=function(b,c){if(null!=c&&null!=b&""!=c&&""!=b){a("#h_cs_share_title").html(b);var d="http://furzr.net/?csid="+c;window.history.pushState({csid:c},"furzr","/?csid="+c);a("#div_cs_url").val(d);f||(a("#div_cs_share").slideDown("fast"),f=!0)}else a("#div_cs_share").hide(),f=!1},M=function(b){H(!0);a.ajax({type:"GET",data:{time:(new Date).getTime(),csid:b},url:"getcs",success:Y})},Y=function(a){a=jQuery.parseJSON(a);a.hasOwnProperty("crazySnake")&&(a.crazySnake.hasOwnProperty("api")&&h.getApiName()!=
a.crazySnake.api?D(a.crazySnake.api):"lastfm"!=h.getApiName()&&D("lastfm"),w=a.artistA,v=a.artistB,p=a.crazySnake.hasOwnProperty("inputIds")?a.crazySnake.inputIds:a.crazySnake.inputArtistsMbids,k=a.crazySnake.hasOwnProperty("explodedIds")?a.crazySnake.explodedIds:a.crazySnake.explodedArtistsMbids,N(a.crazySnake.artistA,""),A(),B(a.name,a.csid))},N=function(a,b){var c={name:a.name,id:a.hasOwnProperty("id")?a.id:a.mbid,mbid:a.hasOwnProperty("mbid")?a.mbid:"",isInput:a.isInput,isExploded:a.isExploded},
d=h.getArtistId(c);n.addNode(d,c);""!=b&&n.addEdge(b,d);if(a.hasOwnProperty("children")&&null!=a.children&&0<a.children.length)for(var e in a.children)N(a.children[e],d)},L=function(){a("#div_cs_popular_list_scroll").html('<img src="theme/blue/spinner.gif"/>');a.ajax({type:"GET",data:{time:(new Date).getTime(),max:50},url:"getcslist",success:Z})},Z=function(b){b=jQuery.parseJSON(b);if(b.hasOwnProperty("crazySnakeList")){var c="",d;for(d in b.crazySnakeList)var e=b.crazySnakeList[d],c=c+('<div id="div_cs_popular_list_element_'+
d+'" class="cs_popular_list_element">'),c=c+('<span class="span_cs_popular_list_element_name">'+e.name+'</span> (by <span class="span_cs_popular_list_element_nickname">'+(""===e.nickname?"anonymous":e.nickname)+"</span>)"),c=c+('<span class="button_cs_popular_list_element_load" data="'+e.csid+'">Load</span>'),c=c+"<br/>",c=c+("from "+e.artistA+" to "+e.artistB),c=c+"</div>";a("#div_cs_popular_list_scroll").html(c);a(".button_cs_popular_list_element_load").click(aa)}},aa=function(a){a=a.target.getAttribute("data",
1);M(a)},ba=function(a){a=a.target.getAttribute("data",1);var b=encodeURIComponent(window.location),d="",d=""!=c&&f?c:"Furzr is a new way to explore the world of music, browsing relationships between artists or bands and listening samples. This app lets you expand your musical knowledge like the leaves of a tree and find out what you will be listening soon.";switch(a){case "facebook":window.open("https://www.facebook.com/sharer/sharer.php?u="+b,"Share on Facebook","width=626,height=436");break;case "twitter":window.open("https://twitter.com/intent/tweet?text="+
(""!=c?c:"")+" "+b,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600");break;case "plusone":window.open("https://plus.google.com/share?url="+b,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600");break;case "stumbleupon":window.open("http://www.stumbleupon.com/submit?url="+b,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=820");break;case "reddit":window.open("http://reddit.com/submit?url="+b,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600");
break;case "delicious":window.open("http://delicious.com/save?v=5&provider=furzr&noui&jump=close&url="+b+"&title=furzr","delicious","toolbar=no,width=550,height=550");break;case "pinterest":window.open("//pinterest.com/pin/create/button/?url="+b+"&media="+encodeURIComponent("http://furzr.net/img/furzr-logo-256.png")+"&description="+encodeURIComponent(d),"","toolbar=no,width=550,height=550");break;case "tumblr":window.open("http://www.tumblr.com/share/link?url="+b+"&name="+encodeURIComponent("furzr")+
"&description="+encodeURIComponent(d),"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600");break;case "digg":window.open("http://digg.com/submit?phase=2&url="+b+"&title=furzr&bodytext="+encodeURIComponent(d)+"&topic=music","","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600");break;case "linkedin":window.open("http://www.linkedin.com/shareArticle?mini=true&url="+b+"&title=furzr&source=http://furzr.net","","toolbar=no,width=550,height=550")}},I=function(b){a("#div_artist_overview").hide();
h.getInfos(b,ca)},ca=function(b){if(null!=b){a("#h3_artist_overview_name").html("About "+b.name);a("#a_artist_overview_lien").attr("href",b.url);var c=replaceAll(b.bio," href=",' target="_blank" href=');a("#span_artist_overview_description").html(c);a("#img_artist_overview_image").attr("src",b.image);a("#span_artist_overview_tags").html(b.tags);a("#div_artist_overview").fadeIn("fast")}},D=function(a){switch(a){case "lastfm":h=apiLastFM;break;case "spotify":h=apiSpotify;break;case "amgsimilars":case "amginfluencers":case "amgfollowers":case "amgmoviesimilars":case "amgmovierelated":h=
apiAmg;break;default:h=apiLastFM}h.init(t,u,z,'<img src="theme/blue/spinner.gif"/>',a)},C=function(){y||a("header").hide();a("#button_sound_volume").fadeIn("slow");a("#div_more").show();a("#div_bottom_left_tools").fadeIn("slow");a("#div_crazy_snake").fadeIn("slow");L();A();y||s||a("#div_bottom_ad").show()},O=function(b){(y=640>a(window).width())&&C()};a(document).ready(function(){jQuery.support.cors=!0;O(null);a.ajax({type:"GET",url:"vue",data:{time:(new Date).getTime(),urlParameters:location.href}});
a(window).resize(O);a("#button_artist").click(E);a("#input_artist").keypress(b);a("#button_clear").click(S);a("#button_contact_send").click(U);a("#button_cs_save").click(V);a("#button_cs_save_form").click(X);a(".span_social_share").click(ba);a("#button_close_pub").click(function(){a("#div_bottom_ad").hide();s=!0});n=arbor.ParticleSystem(1E3,100,0.1);n.parameters({gravity:!0});n.renderer=l("#canvas");setFocusOn("#input_artist");"http://isoartistictree.appspot.com"===location.origin&&(window.location.href=
"http://furzr.net"+location.search);u="off"===getURLParameter("sound")?!1:!0;z="always"===getURLParameter("proxy")?!0:!1;var c=getURLParameter("similar_number");"null"!=c&&(t=c);c=getURLParameter("api");"null"!=c?D(c):D("lastfm");c=getURLParameter("csid");"null"!=c?(C(),M(c)):(c=getURLParameter("artist"),"null"!=c?(g=4,a("#input_artist").val(c),C(),F(c)):(a(".state_header_normal").toggleClass("state_header_start",!0),a(".state_div_input_artist_normal").toggleClass("state_div_input_artist_start",!0),
a("#div_voile").fadeIn(),g=1))})})(this.jQuery);
